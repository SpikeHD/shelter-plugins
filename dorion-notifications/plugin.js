(()=>{var D=Object.create;var a=Object.defineProperty,R=Object.defineProperties,v=Object.getOwnPropertyDescriptor,U=Object.getOwnPropertyDescriptors,F=Object.getOwnPropertyNames,b=Object.getOwnPropertySymbols,J=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var E=(n,e,t)=>e in n?a(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,g=(n,e)=>{for(var t in e||={})T.call(e,t)&&E(n,t,e[t]);if(b)for(var t of b(e))L.call(e,t)&&E(n,t,e[t]);return n},p=(n,e)=>R(n,U(e));var M=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),B=(n,e)=>{for(var t in e)a(n,t,{get:e[t],enumerable:!0})},C=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of F(e))!T.call(n,i)&&i!==t&&a(n,i,{get:()=>e[i],enumerable:!(r=v(e,i))||r.enumerable});return n};var G=(n,e,t)=>(t=n!=null?D(J(n)):{},C(e||!n||!n.__esModule?a(t,"default",{value:n,enumerable:!0}):t,n)),H=n=>C(a({},"__esModule",{value:!0}),n);var c=(n,e,t)=>new Promise((r,i)=>{var x=o=>{try{u(t.next(o))}catch(_){i(_)}},A=o=>{try{u(t.throw(o))}catch(_){i(_)}},u=o=>o.done?r(o.value):Promise.resolve(o.value).then(x,A);u((t=t.apply(n,e)).next())});var y=M((X,I)=>{I.exports=shelter.solidWeb});var Q={};B(Q,{onLoad:()=>z,onUnload:()=>K});var h=G(y(),1);var{ui:{SwitchItem:O},flux:{dispatcher:d},solid:{createSignal:P},observeDom:j,patcher:W}=shelter,{invoke:l}=window.__TAURI__,[s,N]=P(null),$='div[class*="contentColumn"] div[class*="container"]',q=W.instead("Notification",window,()=>{}),f=null,S=!1,w=!1,m=n=>c(void 0,null,function*(){if(n.section!=="Notifications"){S=!1,w=!1;return}else if(S)return;S=!0,f=j($,e=>{f.now(),e.style.display="none";let t=e.nextElementSibling;if(t&&(t.style.display="none"),w)return;let r=[(0,h.createComponent)(O,{note:"Shows a red badge on the app icon when you have unread messages.",get value(){var i;return(i=s())==null?void 0:i.unread_badge},onChange:i=>c(void 0,null,function*(){N(p(g({},s()),{unread_badge:i})),yield l("write_config_file",{contents:JSON.stringify(s())}),window.Dorion.shouldShowUnreadBadge=i,i?window.Dorion.util.applyNotificationCount():l("notif_count",{amount:0})}),children:"Enable Unread Message Badge"}),(0,h.createComponent)(O,{note:"If you're looking for per-channel or per-server notifications, right-click the desired server icon and select Notification Settings.",get value(){var i;return(i=s())==null?void 0:i.desktop_notifications},onChange:i=>c(void 0,null,function*(){N(p(g({},s()),{desktop_notifications:i})),yield l("write_config_file",{contents:JSON.stringify(s())})}),children:"Enable Desktop Notifications"})];for(let i of r)e.parentElement.prepend(i);w=!0})}),k=n=>{s().desktop_notifications&&l("send_notification",{title:n.title,body:n.body,icon:n.icon})};d.subscribe("USER_SETTINGS_MODAL_SET_SECTION",m);d.subscribe("RPC_NOTIFICATION_CREATE",k);var z=()=>c(void 0,null,function*(){N(JSON.parse(yield l("read_config_file")))}),K=()=>{f==null||f.now(),d.unsubscribe("USER_SETTINGS_MODAL_SET_SECTION",m),d.unsubscribe("RPC_NOTIFICATION_CREATE",k),q()};return H(Q);})();
