(()=>{var f=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var U=Object.prototype.hasOwnProperty;var S=(n,e)=>{for(var o in e)f(n,o,{get:e[o],enumerable:!0})},C=(n,e,o,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of h(e))!U.call(n,a)&&a!==o&&f(n,a,{get:()=>e[a],enumerable:!(r=A(e,a))||r.enumerable});return n};var x=n=>C(f({},"__esModule",{value:!0}),n);var t=(n,e,o)=>new Promise((r,a)=>{var w=c=>{try{l(o.next(c))}catch(u){a(u)}},_=c=>{try{l(o.throw(c))}catch(u){a(u)}},l=c=>c.done?r(c.value):Promise.resolve(c.value).then(w,_);l((o=o.apply(n,e)).next())});var N={};S(N,{onUnload:()=>F});var k={name:"Dorion",invoke:(n,e)=>{var o;return(o=window.__TAURI__)!=null&&o.invoke?window.__TAURI__.invoke(n,e):window.__TAURI__.core.invoke(n,e)},event:{emit:(n,e)=>window.__TAURI__.event.emit(n,e),listen:(n,e)=>t(void 0,null,function*(){return window.__TAURI__.event.listen(n,e)})},app:{getVersion:()=>window.__TAURI__.app.getVersion()},process:{relaunch:()=>window.__TAURI__.process.relaunch()},apiWindow:{appWindow:{setFullscreen:n=>{var e,o;return(o=(e=window.__TAURI__)==null?void 0:e.webviewWindow)!=null&&o.getCurrent?window.__TAURI__.webviewWindow.getCurrent()[0].setFullscreen(n):window.__TAURI__.window.appWindow.setFullscreen(n)}}}};var b={name:"Flooed",invoke:(n,e)=>window.Flooed.invoke(n,e),event:{emit:()=>{},listen:()=>t(void 0,null,function*(){})},app:{getVersion:()=>window.Flooed.version},process:{relaunch:()=>window.Flooed.invoke("relaunch")},apiWindow:{appWindow:{setFullscreen:n=>window.Flooed.invoke("set_fullscreen",n)}}};var m={name:"Unknown",invoke:()=>t(void 0,null,function*(){}),event:{emit:()=>{},listen:()=>t(void 0,null,function*(){})},app:{getVersion:()=>"0.0.0"},process:{relaunch:()=>{}},apiWindow:{appWindow:{setFullscreen:()=>{}}}};var p="None";window.Dorion?p="Dorion":window.Flooed&&(p="Flooed");var s;switch(p){case"Dorion":s=k;break;case"Flooed":s=b;break;default:s=m;break}var j=window[p];var q=s.name,v=s.invoke,K=s.event,z=s.app,M=s.process,H=s.apiWindow;var{flux:{dispatcher:d}}=shelter,i={video:!1,streaming:!1,deafened:!1,muted:!1,speaking:!1,connected:!1},y=n=>t(void 0,null,function*(){let{state:e}=n;e.toLowerCase()==="connected"||e.toLowerCase()==="connecting"?i.connected=!0:e.toLowerCase()==="disconnected"&&(i.connected=!1),yield g()}),I=n=>t(void 0,null,function*(){let e=localStorage.getItem("user_id_cache").replace(/"/g,""),o=n.voiceStates.find(l=>l.userId===e);if(!o)return;let{selfDeaf:r,selfMute:a,selfStream:w,selfVideo:_}=o;i.muted=a,i.deafened=r,i.streaming=w,i.video=_,yield g()}),T=n=>t(void 0,null,function*(){let e=localStorage.getItem("user_id_cache").replace(/"/g,""),{userId:o,speakingFlags:r}=n;o===e&&(i.speaking=r>0,yield g())}),g=()=>t(void 0,null,function*(){let n=Object.keys(i).find(e=>i[e])||"disconnected";yield v("set_tray_icon",{event:n})});d.subscribe("VOICE_STATE_UPDATES",I);d.subscribe("SPEAKING",T);d.subscribe("RTC_CONNECTION_STATE",y);var F=()=>{d.unsubscribe("VOICE_STATE_UPDATES",I),d.unsubscribe("SPEAKING",T),d.unsubscribe("RTC_CONNECTION_STATE",y)};return x(N);})();
