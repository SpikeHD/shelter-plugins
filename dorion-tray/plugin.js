(()=>{var f=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var h=Object.prototype.hasOwnProperty;var S=(n,e)=>{for(var o in e)f(n,o,{get:e[o],enumerable:!0})},U=(n,e,o,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of N(e))!h.call(n,t)&&t!==o&&f(n,t,{get:()=>e[t],enumerable:!(r=A(e,t))||r.enumerable});return n};var x=n=>U(f({},"__esModule",{value:!0}),n);var a=(n,e,o)=>new Promise((r,t)=>{var u=c=>{try{l(o.next(c))}catch(_){t(_)}},w=c=>{try{l(o.throw(c))}catch(_){t(_)}},l=c=>c.done?r(c.value):Promise.resolve(c.value).then(u,w);l((o=o.apply(n,e)).next())});var E={};S(E,{onUnload:()=>C});var m={name:"Dorion",invoke:(n,e)=>window.__TAURI__.invoke(n,e),event:{emit:(n,e)=>window.__TAURI__.event.emit(n,e),listen:(n,e)=>a(void 0,null,function*(){return window.__TAURI__.event.listen(n,e)})},app:{getVersion:()=>window.__TAURI__.app.getVersion(),getName:()=>window.__TAURI__.app.getName()},process:{relaunch:()=>window.__TAURI__.process.relaunch()},apiWindow:{appWindow:{setFullscreen:n=>window.__TAURI__.window.appWindow.setFullscreen(n)}}};var b={name:"Flooed",invoke:()=>a(void 0,null,function*(){}),event:{emit:()=>{},listen:()=>a(void 0,null,function*(){})},app:{getVersion:()=>"0.0.0",getName:()=>"None"},process:{relaunch:()=>{}},apiWindow:{appWindow:{setFullscreen:()=>{}}}};var k={name:"Unknown",invoke:()=>a(void 0,null,function*(){}),event:{emit:()=>{},listen:()=>a(void 0,null,function*(){})},app:{getVersion:()=>"0.0.0",getName:()=>"None"},process:{relaunch:()=>{}},apiWindow:{appWindow:{setFullscreen:()=>{}}}};var p="None";window.Dorion?p="Dorion":window.Flooed&&(p="Flooed");var s;switch(p){case"Dorion":s=m;break;case"Flooed":s=b;break;default:s=k;break}var j=window[p];var q=s.name,y=s.invoke,K=s.event,z=s.app,M=s.process,H=s.apiWindow;var{flux:{dispatcher:d}}=shelter,i={video:!1,streaming:!1,deafened:!1,muted:!1,speaking:!1,connected:!1},I=n=>a(void 0,null,function*(){let{state:e}=n;e.toLowerCase()==="connected"||e.toLowerCase()==="connecting"?i.connected=!0:e.toLowerCase()==="disconnected"&&(i.connected=!1),yield g()}),T=n=>a(void 0,null,function*(){let e=localStorage.getItem("user_id_cache").replace(/"/g,""),o=n.voiceStates.find(l=>l.userId===e);if(!o)return;let{selfDeaf:r,selfMute:t,selfStream:u,selfVideo:w}=o;i.muted=t,i.deafened=r,i.streaming=u,i.video=w,yield g()}),v=n=>a(void 0,null,function*(){let e=localStorage.getItem("user_id_cache").replace(/"/g,""),{userId:o,speakingFlags:r}=n;o===e&&(i.speaking=r>0,yield g())}),g=()=>a(void 0,null,function*(){let n=Object.keys(i).find(e=>i[e])||"disconnected";yield y("set_tray_icon",{event:n})});d.subscribe("VOICE_STATE_UPDATES",T);d.subscribe("SPEAKING",v);d.subscribe("RTC_CONNECTION_STATE",I);var C=()=>{d.unsubscribe("VOICE_STATE_UPDATES",T),d.unsubscribe("SPEAKING",v),d.unsubscribe("RTC_CONNECTION_STATE",I)};return x(E);})();
