(()=>{var _=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var S=Object.prototype.hasOwnProperty;var x=(e,n)=>{for(var o in n)_(e,o,{get:n[o],enumerable:!0})},F=(e,n,o,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let t of h(n))!S.call(e,t)&&t!==o&&_(e,t,{get:()=>n[t],enumerable:!(r=A(n,t))||r.enumerable});return e};var N=e=>F(_({},"__esModule",{value:!0}),e);var a=(e,n,o)=>new Promise((r,t)=>{var u=c=>{try{l(o.next(c))}catch(f){t(f)}},w=c=>{try{l(o.throw(c))}catch(f){t(f)}},l=c=>c.done?r(c.value):Promise.resolve(c.value).then(u,w);l((o=o.apply(e,n)).next())});var U={};x(U,{onUnload:()=>C});var k={name:"Dorion",invoke:(e,n)=>window.__TAURI__.invoke(e,n),event:{emit:(e,n)=>window.__TAURI__.event.emit(e,n),listen:(e,n)=>a(void 0,null,function*(){return window.__TAURI__.event.listen(e,n)})},app:{getVersion:()=>window.__TAURI__.app.getVersion()},process:{relaunch:()=>window.__TAURI__.process.relaunch()},apiWindow:{appWindow:{setFullscreen:e=>window.__TAURI__.window.appWindow.setFullscreen(e)}}};var m={name:"Flooed",invoke:(e,n)=>window.Flooed.invoke(e,n),event:{emit:()=>{},listen:()=>a(void 0,null,function*(){})},app:{getVersion:()=>window.Flooed.version},process:{relaunch:()=>window.Flooed.invoke("relaunch")},apiWindow:{appWindow:{setFullscreen:e=>window.Flooed.invoke("set_fullscreen",e)}}};var b={name:"Unknown",invoke:()=>a(void 0,null,function*(){}),event:{emit:()=>{},listen:()=>a(void 0,null,function*(){})},app:{getVersion:()=>"0.0.0"},process:{relaunch:()=>{}},apiWindow:{appWindow:{setFullscreen:()=>{}}}};var p="None";window.Dorion?p="Dorion":window.Flooed&&(p="Flooed");var s;switch(p){case"Dorion":s=k;break;case"Flooed":s=m;break;default:s=b;break}var j=window[p];var q=s.name,v=s.invoke,K=s.event,z=s.app,M=s.process,H=s.apiWindow;var{flux:{dispatcher:d}}=shelter,i={video:!1,streaming:!1,deafened:!1,muted:!1,speaking:!1,connected:!1},y=e=>a(void 0,null,function*(){let{state:n}=e;n.toLowerCase()==="connected"||n.toLowerCase()==="connecting"?i.connected=!0:n.toLowerCase()==="disconnected"&&(i.connected=!1),yield g()}),I=e=>a(void 0,null,function*(){let n=localStorage.getItem("user_id_cache").replace(/"/g,""),o=e.voiceStates.find(l=>l.userId===n);if(!o)return;let{selfDeaf:r,selfMute:t,selfStream:u,selfVideo:w}=o;i.muted=t,i.deafened=r,i.streaming=u,i.video=w,yield g()}),T=e=>a(void 0,null,function*(){let n=localStorage.getItem("user_id_cache").replace(/"/g,""),{userId:o,speakingFlags:r}=e;o===n&&(i.speaking=r>0,yield g())}),g=()=>a(void 0,null,function*(){let e=Object.keys(i).find(n=>i[n])||"disconnected";yield v("set_tray_icon",{event:e})});d.subscribe("VOICE_STATE_UPDATES",I);d.subscribe("SPEAKING",T);d.subscribe("RTC_CONNECTION_STATE",y);var C=()=>{d.unsubscribe("VOICE_STATE_UPDATES",I),d.unsubscribe("SPEAKING",T),d.unsubscribe("RTC_CONNECTION_STATE",y)};return N(U);})();
