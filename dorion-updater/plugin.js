(()=>{var U=Object.create;var l=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var D=Object.getPrototypeOf,W=Object.prototype.hasOwnProperty;var F=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports),R=(e,n)=>{for(var o in n)l(e,o,{get:n[o],enumerable:!0})},y=(e,n,o,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of A(n))!W.call(e,i)&&i!==o&&l(e,i,{get:()=>n[i],enumerable:!(t=N(n,i))||t.enumerable});return e};var B=(e,n,o)=>(o=e!=null?U(D(e)):{},y(n||!e||!e.__esModule?l(o,"default",{value:e,enumerable:!0}):o,e)),I=e=>y(l({},"__esModule",{value:!0}),e);var a=(e,n,o)=>new Promise((t,i)=>{var C=s=>{try{u(o.next(s))}catch(m){i(m)}},T=s=>{try{u(o.throw(s))}catch(m){i(m)}},u=s=>s.done?t(s.value):Promise.resolve(s.value).then(C,T);u((o=o.apply(e,n)).next())});var g=F((j,_)=>{_.exports=shelter.solidWeb});var P={};R(P,{onUnload:()=>q});var d=B(g(),1);var h={name:"Dorion",invoke:(e,n)=>window.__TAURI__.invoke(e,n),event:{emit:(e,n)=>window.__TAURI__.event.emit(e,n),listen:(e,n)=>a(void 0,null,function*(){return window.__TAURI__.event.listen(e,n)})},app:{getVersion:()=>window.__TAURI__.app.getVersion(),getName:()=>window.__TAURI__.app.getName()},process:{relaunch:()=>window.__TAURI__.process.relaunch()},apiWindow:{appWindow:{setFullscreen:e=>window.__TAURI__.window.appWindow.setFullscreen(e)}}};var k={name:"Flooed",invoke:()=>a(void 0,null,function*(){}),event:{emit:()=>{},listen:()=>a(void 0,null,function*(){})},app:{getVersion:()=>"0.0.0",getName:()=>"None"},process:{relaunch:()=>{}},apiWindow:{appWindow:{setFullscreen:()=>{}}}};var b={name:"Unknown",invoke:()=>a(void 0,null,function*(){}),event:{emit:()=>{},listen:()=>a(void 0,null,function*(){})},app:{getVersion:()=>"0.0.0",getName:()=>"None"},process:{relaunch:()=>{}},apiWindow:{appWindow:{setFullscreen:()=>{}}}};var c="None";window.Dorion?c="Dorion":window.Flooed&&(c="Flooed");var r;switch(c){case"Dorion":r=h;break;case"Flooed":r=k;break;default:r=b;break}var Z=window[c];var ee=r.name,p=r.invoke,x=r.event,ne=r.app,v=r.process,oe=r.apiWindow;var{ui:{openModal:f,ModalRoot:M,ModalHeader:G,ModalBody:S,ModalConfirmFooter:V}}=shelter,w=e=>(0,d.createComponent)(M,{get children(){return[(0,d.createComponent)(G,{get close(){return e.onCancel},get children(){return e.header}}),(0,d.createComponent)(S,{get children(){return e.body}}),(0,d.createComponent)(V,{get onConfirm(){return e.onConfirm},get onCancel(){return e.onCancel},get confirmText(){return e.confirmText},get cancelText(){return e.cancelText},get type(){return e.type}})]}}),O=()=>a(void 0,null,function*(){console.log("[Updater] Checking for updates...");let e=JSON.parse(yield p("read_config_file")),n=yield p("update_check"),o=()=>{p("do_update",{toUpdate:n})};if(console.log(`[Updater] Dorion things to update: ${n}`),!(e.update_notify!==void 0&&!e.update_notify)){if(n.includes("dorion")){if(e.autoupdate){f(t=>w({header:"Dorion Update",body:"A Dorion update has been fetched, and Dorion will restart momentarily.",confirmText:"Got it!",type:"neutral",onConfirm:()=>o(),onCancel:t.close})),o();return}f(t=>w({header:"Updates Available!",body:"There are Dorion updates available. Would you like to apply them? This notification can be disabled in Dorion Settings",confirmText:"Yes please!",cancelText:"Nope!",type:"neutral",onConfirm:()=>o(),onCancel:t.close}))}x.once("update_complete",()=>{f(t=>w({header:"Update Complete!",body:"The update has been applied! Please restart to apply the changes.",confirmText:"Okay!",type:"neutral",onConfirm:()=>v.relaunch(),onCancel:t.close}))})}}),q=()=>{};O();return I(P);})();
