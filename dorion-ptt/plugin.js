(()=>{var b=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var F=Object.prototype.hasOwnProperty;var U=(n,e)=>{for(var o in e)b(n,o,{get:e[o],enumerable:!0})},I=(n,e,o,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of A(e))!F.call(n,s)&&s!==o&&b(n,s,{get:()=>e[s],enumerable:!(t=E(e,s))||t.enumerable});return n};var B=n=>I(b({},"__esModule",{value:!0}),n);var a=(n,e,o)=>new Promise((t,s)=>{var p=i=>{try{k(o.next(i))}catch(u){s(u)}},D=i=>{try{k(o.throw(i))}catch(u){s(u)}},k=i=>i.done?t(i.value):Promise.resolve(i.value).then(p,D);k((o=o.apply(n,e)).next())});var M={};U(M,{onUnload:()=>P});var m=n=>{let e="";switch(n){case 8:e="Backspace";break;case 9:e="Tab";break;case 13:e="Enter";break;case 16:e="Shift";break;case 17:e="Control";break;case 18:e="Alt";break;case 20:e="CapsLock";break;case 27:e="Escape";break;case 32:e="Space";break;case 33:e="PageUp";break;case 34:e="PageDown";break;case 35:e="End";break;case 36:e="Home";break;case 37:e="Left";break;case 38:e="Up";break;case 39:e="Right";break;case 40:e="Down";break;case 45:e="Insert";break;case 46:e="Delete";break;default:e=String.fromCharCode(n);break}return e};var g={name:"Dorion",invoke:(n,e)=>window.__TAURI__.invoke(n,e),event:{emit:(n,e)=>window.__TAURI__.event.emit(n,e),listen:(n,e)=>a(void 0,null,function*(){return window.__TAURI__.event.listen(n,e)})},app:{getVersion:()=>window.__TAURI__.app.getVersion()},process:{relaunch:()=>window.__TAURI__.process.relaunch()},apiWindow:{appWindow:{setFullscreen:n=>window.__TAURI__.window.appWindow.setFullscreen(n)}}};var y={name:"Flooed",invoke:(n,e)=>window.Flooed.invoke(n,e),event:{emit:()=>{},listen:()=>a(void 0,null,function*(){})},app:{getVersion:()=>window.Flooed.version},process:{relaunch:()=>window.Flooed.invoke("relaunch")},apiWindow:{appWindow:{setFullscreen:n=>window.Flooed.invoke("set_fullscreen",n)}}};var f={name:"Unknown",invoke:()=>a(void 0,null,function*(){}),event:{emit:()=>{},listen:()=>a(void 0,null,function*(){})},app:{getVersion:()=>"0.0.0"},process:{relaunch:()=>{}},apiWindow:{appWindow:{setFullscreen:()=>{}}}};var c="None";window.Dorion?c="Dorion":window.Flooed&&(c="Flooed");var r;switch(c){case"Dorion":r=g;break;case"Flooed":r=y;break;default:r=f;break}var Z=window[c];var $=r.name,w=r.invoke,h=r.event,ee=r.app,ne=r.process,oe=r.apiWindow;var{flux:{dispatcher:d,stores:{UserStore:_}},observeDom:l}=shelter,x=[],T=[],S=[],C='div[class*="pttToolsMessage_"]',R='div[class*="radioBar_"]',H='div[class*="layerContainer_"] div[class*="layer_"]',v=()=>S.forEach(n=>n()),L=n=>a(void 0,null,function*(){if(n.section!=="Voice & Video"){v();return}S.push(l(C,e=>{e.remove()}),l(H,e=>{if(e.id)return;e.innerHTML="";let o=l('div[class*="backdrop_"]',t=>{t.click(),o()})}),l(R,e=>{let o='div[class*="info_"] div[class*="text"]',t=e.querySelector(o);t.textContent.includes("(")&&(t.textContent=t.textContent.replace(/\(.+?\)/g,""))}))}),N=n=>a(void 0,null,function*(){let{mode:e,options:{shortcut:o}}=n,s=o.map(p=>p[1]).map(m);w("save_ptt_keys",{keys:s}),w("toggle_ptt",{state:e==="PUSH_TO_TALK"})}),W=n=>a(void 0,null,function*(){var t;let{state:e}=n.payload,o={type:"SPEAKING",context:"default",userId:(t=_==null?void 0:_.getCurrentUser())==null?void 0:t.id,speakingFlags:e?1:0};console.log("Toggle handler called with state: ",e),d.dispatch(o)});T.push(d.subscribe("USER_SETTINGS_MODAL_SET_SECTION",L),d.subscribe("LAYER_POP",v),d.subscribe("AUDIO_SET_MODE",N));h.listen("ptt_toggle",W).then(n=>x.push(n));var P=()=>{v(),x.forEach(n=>n()),T.forEach(n=>n())};return B(M);})();
