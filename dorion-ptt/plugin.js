(()=>{var w=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var B=(e,o)=>{for(var n in o)w(e,n,{get:o[n],enumerable:!0})},N=(e,o,n,t)=>{if(o&&typeof o=="object"||typeof o=="function")for(let a of E(o))!C.call(e,a)&&a!==n&&w(e,a,{get:()=>o[a],enumerable:!(t=A(o,a))||t.enumerable});return e};var U=e=>N(w({},"__esModule",{value:!0}),e);var s=(e,o,n)=>new Promise((t,a)=>{var p=i=>{try{u(n.next(i))}catch(m){a(m)}},D=i=>{try{u(n.throw(i))}catch(m){a(m)}},u=i=>i.done?t(i.value):Promise.resolve(i.value).then(p,D);u((n=n.apply(e,o)).next())});var G={};B(G,{onUnload:()=>P});var g={112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",27:"Escape",32:"Space",17:"Control",16:"Shift",18:"Alt",91:"Meta",13:"Enter",38:"Up",40:"Down",37:"Left",39:"Right",8:"Backspace",20:"CapsLock",9:"Tab",36:"Home",35:"End",33:"PageUp",34:"PageDown",45:"Insert",46:"Delete",109:"NumpadSubtract",107:"NumpadAdd",111:"NumpadDivide",106:"NumpadMultiply",192:"Grave",189:"Minus",187:"Equal",219:"LeftBracket",221:"RightBracket",220:"BackSlash",186:"Semicolon",222:"Apostrophe",188:"Comma",190:"Dot",191:"Slash"},b=e=>{let o="";return e>=65&&e<=90&&(o=String.fromCharCode(e)),e>=97&&e<=122&&(o=String.fromCharCode(e-32)),e>=48&&e<=57&&(o=String.fromCharCode(e)),g[e]&&(o=g[e]),o};var k={name:"Dorion",invoke:(e,o)=>window.__TAURI__.invoke(e,o),event:{emit:(e,o)=>window.__TAURI__.event.emit(e,o),listen:(e,o)=>s(void 0,null,function*(){return window.__TAURI__.event.listen(e,o)})},app:{getVersion:()=>window.__TAURI__.app.getVersion()},process:{relaunch:()=>window.__TAURI__.process.relaunch()},apiWindow:{appWindow:{setFullscreen:e=>window.__TAURI__.window.appWindow.setFullscreen(e)}}};var h={name:"Flooed",invoke:(e,o)=>window.Flooed.invoke(e,o),event:{emit:()=>{},listen:()=>s(void 0,null,function*(){})},app:{getVersion:()=>window.Flooed.version},process:{relaunch:()=>window.Flooed.invoke("relaunch")},apiWindow:{appWindow:{setFullscreen:e=>window.Flooed.invoke("set_fullscreen",e)}}};var y={name:"Unknown",invoke:()=>s(void 0,null,function*(){}),event:{emit:()=>{},listen:()=>s(void 0,null,function*(){})},app:{getVersion:()=>"0.0.0"},process:{relaunch:()=>{}},apiWindow:{appWindow:{setFullscreen:()=>{}}}};var c="None";window.Dorion?c="Dorion":window.Flooed&&(c="Flooed");var r;switch(c){case"Dorion":r=k;break;case"Flooed":r=h;break;default:r=y;break}var $=window[c];var ee=r.name,_=r.invoke,F=r.event,oe=r.app,ne=r.process,te=r.apiWindow;var{flux:{dispatcher:d,stores:{UserStore:v}},observeDom:l}=shelter,S=[],x=[],T=[],I='div[class*="pttToolsMessage_"]',R='div[class*="radioBar_"]',L='div[class*="layerContainer_"] div[class*="layer_"]',f=()=>T.forEach(e=>e()),M=e=>s(void 0,null,function*(){if(e.section!=="Voice & Video"){f();return}T.push(l(I,o=>{o.remove()}),l(L,o=>{if(o.id)return;o.innerHTML="";let n=l('div[class*="backdrop_"]',t=>{t.click(),n()})}),l(R,o=>{let n='div[class*="info_"] div[class*="text"]',t=o.querySelector(n);t.textContent.includes("(")&&(t.textContent=t.textContent.replace(/\(.+?\)/g,""))}))}),H=e=>s(void 0,null,function*(){let{mode:o,options:{shortcut:n}}=e,a=n.map(p=>p[1]).map(b);_("save_ptt_keys",{keys:a}),_("toggle_ptt",{state:o==="PUSH_TO_TALK"})}),W=e=>s(void 0,null,function*(){var t;let{state:o}=e.payload,n={type:"SPEAKING",context:"default",userId:(t=v==null?void 0:v.getCurrentUser())==null?void 0:t.id,speakingFlags:o?1:0};console.log("Toggle handler called with state: ",o),d.dispatch(n)});x.push(d.subscribe("USER_SETTINGS_MODAL_SET_SECTION",M),d.subscribe("LAYER_POP",f),d.subscribe("AUDIO_SET_MODE",H));F.listen("ptt_toggle",W).then(e=>S.push(e));var P=()=>{f(),S.forEach(e=>e()),x.forEach(e=>e())};return U(G);})();
