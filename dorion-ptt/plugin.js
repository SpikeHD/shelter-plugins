(()=>{var d=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var f=Object.prototype.hasOwnProperty;var m=(t,e)=>{for(var s in e)d(t,s,{get:e[s],enumerable:!0})},x=(t,e,s,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of T(e))!f.call(t,o)&&o!==s&&d(t,o,{get:()=>e[o],enumerable:!(a=S(e,o))||a.enumerable});return t};var D=t=>x(d({},"__esModule",{value:!0}),t);var r=(t,e,s)=>new Promise((a,o)=>{var i=c=>{try{b(s.next(c))}catch(k){o(k)}},E=c=>{try{b(s.throw(c))}catch(k){o(k)}},b=c=>c.done?a(c.value):Promise.resolve(c.value).then(i,E);b((s=s.apply(t,e)).next())});var U={};m(U,{onUnload:()=>P});var _=t=>{let e="";switch(t){case 8:e="Backspace";break;case 9:e="Tab";break;case 13:e="Enter";break;case 16:e="Shift";break;case 17:e="Control";break;case 18:e="Alt";break;case 20:e="CapsLock";break;case 27:e="Escape";break;case 32:e="Space";break;case 33:e="PageUp";break;case 34:e="PageDown";break;case 35:e="End";break;case 36:e="Home";break;case 37:e="Left";break;case 38:e="Up";break;case 39:e="Right";break;case 40:e="Down";break;case 45:e="Insert";break;case 46:e="Delete";break;default:e=String.fromCharCode(t);break}return e};var{flux:{dispatcher:l,stores:{UserStore:p}},observeDom:n}=shelter,{invoke:g,event:C}=window.__TAURI__,v=[],h=[],y=[],H='div[class*="pttToolsMessage_"]',L='div[class*="radioBar_"]',A='div[class*="layerContainer_"] div[class*="layer_"]',u=()=>y.forEach(t=>t()),M=t=>r(void 0,null,function*(){if(t.section!=="Voice & Video"){u();return}y.push(n(H,e=>{e.remove()}),n(A,e=>{if(e.id)return;e.innerHTML="";let s=n('div[class*="backdrop_"]',a=>{a.click(),s()})}),n(L,e=>{let s='div[class*="info_"] div[class*="text"]',a=e.querySelector(s);a.textContent.includes("(")&&(a.textContent=a.textContent.replace(/\(.+?\)/g,""))}))}),w=t=>r(void 0,null,function*(){let{mode:e,options:{shortcut:s}}=t,o=s.map(i=>i[1]).map(_);g("save_ptt_keys",{keys:o}),g("toggle_ptt",{state:e==="PUSH_TO_TALK"})}),I=t=>r(void 0,null,function*(){var a;let{state:e}=t.payload,s={type:"SPEAKING",context:"default",userId:(a=p==null?void 0:p.getCurrentUser())==null?void 0:a.id,speakingFlags:e?1:0};console.log("Toggle handler called with state: ",e),l.dispatch(s)});h.push(l.subscribe("USER_SETTINGS_MODAL_SET_SECTION",M),l.subscribe("LAYER_POP",u),l.subscribe("AUDIO_SET_MODE",w));C.listen("ptt_toggle",I).then(t=>v.push(t));var P=()=>{u(),v.forEach(t=>t()),h.forEach(t=>t())};return D(U);})();
